<?xml version="1.0" encoding="UTF-8"?>
<odoo>
    <!-- TBWA Finance Ops Security Groups -->
    <!-- Pilot access for TBWA\SMP Finance users -->

    <!-- Root group for TBWA Finance Ops pilot users -->
    <record id="group_tbwa_fin_ops" model="res.groups">
        <field name="name">TBWA Finance Ops</field>
        <field name="category_id" ref="base.module_category_accounting_finance"/>
        <field name="implied_ids" eval="[(4, ref('base.group_user'))]"/>
        <field name="comment">TBWA\SMP Finance Ops pilot – month-end close + dashboards. Read access to Finance PPM, checklists, and embedded Superset dashboards. No Settings/Apps/Technical.</field>
    </record>

    <!-- Lead group: can approve and update task statuses -->
    <record id="group_tbwa_fin_ops_lead" model="res.groups">
        <field name="name">TBWA Finance Ops Lead</field>
        <field name="category_id" ref="base.module_category_accounting_finance"/>
        <field name="implied_ids" eval="[(4, ref('group_tbwa_fin_ops'))]"/>
        <field name="comment">TBWA\SMP Finance Ops lead – can update task statuses and approve checklists.</field>
    </record>

    <!-- Record Rules: Finance PPM read access for TBWA users -->
    <record id="rule_tbwa_finance_person_read" model="ir.rule">
        <field name="name">TBWA Finance Ops: Person Read</field>
        <field name="model_id" ref="model_ipai_finance_person"/>
        <field name="domain_force">[(1, '=', 1)]</field>
        <field name="groups" eval="[(4, ref('group_tbwa_fin_ops'))]"/>
        <field name="perm_read" eval="True"/>
        <field name="perm_write" eval="False"/>
        <field name="perm_create" eval="False"/>
        <field name="perm_unlink" eval="False"/>
    </record>

    <record id="rule_tbwa_finance_task_read" model="ir.rule">
        <field name="name">TBWA Finance Ops: Task Template Read</field>
        <field name="model_id" ref="model_ipai_finance_task_template"/>
        <field name="domain_force">[(1, '=', 1)]</field>
        <field name="groups" eval="[(4, ref('group_tbwa_fin_ops'))]"/>
        <field name="perm_read" eval="True"/>
        <field name="perm_write" eval="False"/>
        <field name="perm_create" eval="False"/>
        <field name="perm_unlink" eval="False"/>
    </record>

    <record id="rule_tbwa_bir_schedule_read" model="ir.rule">
        <field name="name">TBWA Finance Ops: BIR Schedule Read</field>
        <field name="model_id" ref="model_ipai_bir_form_schedule"/>
        <field name="domain_force">[(1, '=', 1)]</field>
        <field name="groups" eval="[(4, ref('group_tbwa_fin_ops'))]"/>
        <field name="perm_read" eval="True"/>
        <field name="perm_write" eval="False"/>
        <field name="perm_create" eval="False"/>
        <field name="perm_unlink" eval="False"/>
    </record>

    <record id="rule_tbwa_close_task_read" model="ir.rule">
        <field name="name">TBWA Finance Ops: Close Task Read</field>
        <field name="model_id" ref="model_ipai_close_task_template"/>
        <field name="domain_force">[(1, '=', 1)]</field>
        <field name="groups" eval="[(4, ref('group_tbwa_fin_ops'))]"/>
        <field name="perm_read" eval="True"/>
        <field name="perm_write" eval="False"/>
        <field name="perm_create" eval="False"/>
        <field name="perm_unlink" eval="False"/>
    </record>

    <!-- Lead group: can update task status -->
    <record id="rule_tbwa_finance_task_lead" model="ir.rule">
        <field name="name">TBWA Finance Ops Lead: Task Update</field>
        <field name="model_id" ref="model_ipai_finance_task_template"/>
        <field name="domain_force">[(1, '=', 1)]</field>
        <field name="groups" eval="[(4, ref('group_tbwa_fin_ops_lead'))]"/>
        <field name="perm_read" eval="True"/>
        <field name="perm_write" eval="True"/>
        <field name="perm_create" eval="False"/>
        <field name="perm_unlink" eval="False"/>
    </record>

    <record id="rule_tbwa_close_task_lead" model="ir.rule">
        <field name="name">TBWA Finance Ops Lead: Close Task Update</field>
        <field name="model_id" ref="model_ipai_close_task_template"/>
        <field name="domain_force">[(1, '=', 1)]</field>
        <field name="groups" eval="[(4, ref('group_tbwa_fin_ops_lead'))]"/>
        <field name="perm_read" eval="True"/>
        <field name="perm_write" eval="True"/>
        <field name="perm_create" eval="False"/>
        <field name="perm_unlink" eval="False"/>
    </record>

</odoo>
