[options]
; =============================================================================
; Production Odoo Configuration for ipai-platform
; =============================================================================
; Mount into container at /etc/odoo/odoo.conf
; Requires: proxy_mode = True behind Nginx reverse proxy
; =============================================================================

; Addons path
addons_path = /mnt/extra-addons,/usr/lib/python3/dist-packages/odoo/addons

; Database
db_host = ipai-odoo-db
db_port = 5432
db_user = odoo
; db_password loaded from Docker secret or environment
db_name = False
db_filter = ^%d$
list_db = False

; Proxy mode (REQUIRED behind Nginx)
proxy_mode = True

; Workers (production: 2 * CPU cores + 1)
; For 4 CPU cores: workers = 9
; Adjust based on actual server resources
workers = 4
max_cron_threads = 2

; Memory limits
; limit_memory_hard: 2.5GB per worker
; limit_memory_soft: 2GB per worker (restart if exceeded)
limit_memory_hard = 2684354560
limit_memory_soft = 2147483648

; CPU limits
; limit_time_cpu: max CPU time per request (seconds)
; limit_time_real: max wall time per request (seconds)
limit_time_cpu = 600
limit_time_real = 1200
limit_time_real_cron = 3600

; Longpolling
; gevent_port: separate port for long-polling connections
gevent_port = 8072

; Logging
log_level = info
log_handler = :INFO
logfile = /var/log/odoo/odoo-server.log
logrotate = True

; Session storage (Redis for horizontal scaling)
; Uncomment for Redis session support
; session_redis = True
; session_redis_host = ipai-odoo-redis
; session_redis_port = 6379

; Security
; data_dir: persistent storage for filestore
data_dir = /var/lib/odoo

; SMTP (optional - configure for email)
; smtp_server = smtp.mailgun.org
; smtp_port = 587
; smtp_ssl = False
; smtp_user = postmaster@insightpulseai.net
; smtp_password = loaded from environment

; Admin password (set via environment variable ODOO_ADMIN_PASSWORD)
; admin_passwd = loaded from environment

; Performance tuning
; osv_memory_age_limit: age limit for in-memory records (hours)
osv_memory_age_limit = 1.0

; unaccent: enable unaccent extension for search
unaccent = True

; =============================================================================
; Environment Variable Overrides
; =============================================================================
; These can be overridden via Docker environment:
; - ODOO_RC: path to this config file
; - ODOO_ADMIN_PASSWD: admin password
; - ODOO_DB_PASSWORD: database password
; - ODOO_SMTP_PASSWORD: SMTP password
; =============================================================================
