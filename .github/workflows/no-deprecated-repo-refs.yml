name: Block deprecated repo references
on:
  pull_request:
  push:
jobs:
  scan:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - name: Fail if deprecated repo URL appears
        run: |
          set -euo pipefail
          # Exclude generated inventory files and archive
          if grep -r "https://github\.com/jgtolentino/insightpulse-odoo" . \
            --exclude-dir=out \
            --exclude-dir=archive \
            --exclude-dir=.git \
            --exclude="no-deprecated-repo-refs.yml"; then
            echo "Found deprecated repo reference(s). Replace with https://github.com/jgtolentino/odoo-ce"
            exit 1
          fi
