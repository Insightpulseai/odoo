principles:
  - Deterministic factory line for OCA-style Odoo repos, Supabase Platform Kit apps, SaaS starters
  - Template pinning and CI guards prevent drift and workspace bleed
  - Version normalization handled centrally via adapters and agent skills

repository_layout:
  - templates/
  - templates/catalog.yaml
  - templates/odoo/adapters/v18/adapter.py
  - templates/odoo/adapters/v19/adapter.py
  - templates/odoo/adapters/parity_decision_table.md
  - scripts/factory.sh
  - guards/ci_guard_template_pins.sh
  - .github/workflows/template-pins-guard.yml

odoo_version_strategy:
  canonical_internal_contract: "OCA normalization enforced via adapters"
  version_adapters:
    - path: templates/odoo/adapters/v18/adapter.py
      description: "Adapter for Odoo v18 normalization (views, manifests, deprecated features)"
    - path: templates/odoo/adapters/v19/adapter.py
      description: "Adapter for Odoo v19 normalization (views, manifests, deprecated features)"
  parity_decision_table:
    path: templates/odoo/adapters/parity_decision_table.md
    description: "EE → OCA → Adapter normalization logic and enforcement table"
  enforcement:
    - "CI guards block version-specific code outside adapters; only adapters may contain version normalization logic"

factory_cli:
  entrypoint: scripts/factory.sh
  commands:
    - list
    - new
    - verify
    - build
    - publish

ci_guards:
  - guards/ci_guard_template_pins.sh
  - .github/workflows/template-pins-guard.yml
  - "CI rules block version-specific code outside adapters"

catalog_registry:
  file: templates/catalog.yaml
  description: "Registry of templates with pinned SHAs, vendor paths, overlays, and output contracts"

pinning_convention:
  - ".PINNED_SHA files in vendor directories"
  - "Pin guard script enforces presence and validity"

workspace_hygiene:
  - "CI guards prevent workspace bleed and enforce determinism"

agent_skills:
  - oca_resolver
  - odoo_view_migrator
  - manifest_normalizer
  - deprecation_scanner
  - parity_classifier
  description: "Agent skills for migration, normalization, and parity enforcement"
