version: 1
org: Insightpulseai
workspace: ipai

# SSOT = metadata (NOT values)
# values must be supplied at sync-time from env vars (or a secure runner)
secrets:
  - name: CLOUDFLARE_API_TOKEN
    description: Terraform applies DNS/WAF to Cloudflare.
    store: github_actions
    repo: Insightpulseai/odoo
    env_var: CLOUDFLARE_API_TOKEN
    required: true
    rotation_days: 30
    scopes:
      - cloudflare:dns:edit
      - cloudflare:waf:edit
    used_by:
      - .github/workflows/infra-cloudflare-dns.yml
      - .github/workflows/terraform-cloudflare-dns.yml
      - .github/workflows/infra-waf-assessment.yml

  - name: OPENAI_API_KEY
    description: LLM access for runtime (Edge Functions).
    store: supabase_edge_secrets
    supabase_project_ref_env: SUPABASE_PROJECT_REF
    env_var: OPENAI_API_KEY
    required: false
    rotation_days: 90
    used_by:
      - supabase/functions/*

  - name: SUPABASE_SERVICE_ROLE_KEY
    description: Server-side only; used by Edge executors/workers.
    store: supabase_edge_secrets
    supabase_project_ref_env: SUPABASE_PROJECT_REF
    env_var: SUPABASE_SERVICE_ROLE_KEY
    required: true
    rotation_days: 90
    used_by:
      - supabase/functions/*

  - name: SUPABASE_ANON_KEY
    description: Anonymous key for client-side Supabase access.
    store: github_actions
    repo: Insightpulseai/odoo
    env_var: SUPABASE_ANON_KEY
    required: true
    rotation_days: 365
    used_by:
      - .github/workflows/supabase-deploy.yml
      - .github/workflows/supabase-db-push.yml

  - name: GITHUB_TOKEN
    description: GitHub API access (auto-provided by Actions, documented for reference).
    store: github_actions
    repo: Insightpulseai/odoo
    env_var: GITHUB_TOKEN
    required: true
    rotation_days: 0  # Auto-rotated by GitHub
    auto_injected: true
    used_by:
      - .github/workflows/*

  - name: DO_ACCESS_TOKEN
    description: DigitalOcean API access for App Platform operations.
    store: github_actions
    repo: Insightpulseai/odoo
    env_var: DO_ACCESS_TOKEN
    required: false
    rotation_days: 90
    scopes:
      - app:read
      - app:write
    used_by:
      - .github/workflows/deploy-odoo-prod.yml
