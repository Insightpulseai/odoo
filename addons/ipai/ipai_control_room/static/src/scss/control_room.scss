/**
 * Control Room Styles
 *
 * Uses Fluent 2 design tokens from ipai_theme_fluent2.
 * Extends base Odoo styles with Control Room-specific components.
 *
 * Token Reference:
 *   - Colors: var(--colorBrand*), var(--colorNeutral*), var(--colorPalette*)
 *   - Typography: var(--fontFamily*), var(--fontSize*), var(--fontWeight*)
 *   - Spacing: var(--spacingHorizontal*), var(--spacingVertical*)
 *   - Shapes: var(--borderRadius*), var(--strokeWidth*)
 *   - Shadows: var(--shadow*)
 *   - Animations: var(--duration*), var(--curve*)
 */

/* ==================== Control Room Variables ==================== */

:root {
  /* Control Room specific tokens (extending Fluent 2) */
  --cr-sidebar-width: 260px;
  --cr-header-height: 56px;
  --cr-card-padding: var(--spacingVerticalL) var(--spacingHorizontalL);

  /* Status colors using Fluent palette */
  --cr-status-success: var(--colorPaletteGreenForeground1, #107c10);
  --cr-status-warning: var(--colorPaletteYellowForeground1, #835c00);
  --cr-status-error: var(--colorPaletteRedForeground1, #c42b1c);
  --cr-status-info: var(--colorBrandForeground1, #0f6cbd);
  --cr-status-muted: var(--colorNeutralForeground4, #707070);

  /* Pipeline state colors */
  --cr-state-queued: var(--colorNeutralForeground3, #616161);
  --cr-state-running: var(--colorPaletteYellowForeground1, #835c00);
  --cr-state-succeeded: var(--colorPaletteGreenForeground1, #107c10);
  --cr-state-failed: var(--colorPaletteRedForeground1, #c42b1c);
  --cr-state-canceled: var(--colorNeutralForeground4, #707070);

  /* DQ severity colors */
  --cr-severity-low: var(--colorNeutralForeground3, #616161);
  --cr-severity-medium: var(--colorPaletteYellowForeground1, #835c00);
  --cr-severity-high: var(--colorPaletteOrangeForeground1, #c55a00);
  --cr-severity-critical: var(--colorPaletteRedForeground1, #c42b1c);
}

/* Dark theme adjustments */
:root[data-theme="dark"] {
  --cr-status-success: var(--colorPaletteGreenForeground1, #5ec75a);
  --cr-status-warning: var(--colorPaletteYellowForeground1, #fce100);
  --cr-status-error: var(--colorPaletteRedForeground1, #ff6767);
  --cr-status-info: var(--colorBrandForeground1, #479ef5);
  --cr-status-muted: var(--colorNeutralForeground4, #999999);
}

/* ==================== Control Room Cards ==================== */

.cr-card {
  background: var(--colorNeutralBackground1, #ffffff);
  border: 1px solid var(--colorNeutralStroke1, #d1d1d1);
  border-radius: var(--borderRadiusLarge, 6px);
  box-shadow: var(--shadow4, 0 2px 4px rgba(0, 0, 0, 0.04));
  padding: var(--cr-card-padding);
  transition: box-shadow var(--durationNormal, 200ms) var(--curveEasyEase);

  &:hover {
    box-shadow: var(--shadow8, 0 4px 8px rgba(0, 0, 0, 0.08));
  }

  &--clickable {
    cursor: pointer;
  }

  &__header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    margin-bottom: var(--spacingVerticalM, 12px);
  }

  &__title {
    font-family: var(--fontFamilyBase);
    font-size: var(--fontSizeBase400, 16px);
    font-weight: var(--fontWeightSemibold, 600);
    color: var(--colorNeutralForeground1, #242424);
    margin: 0;
  }

  &__subtitle {
    font-size: var(--fontSizeBase200, 12px);
    color: var(--colorNeutralForeground3, #616161);
    margin-top: var(--spacingVerticalXS, 4px);
  }

  &__content {
    font-size: var(--fontSizeBase300, 14px);
    color: var(--colorNeutralForeground2, #424242);
  }

  &__footer {
    margin-top: var(--spacingVerticalM, 12px);
    padding-top: var(--spacingVerticalM, 12px);
    border-top: 1px solid var(--colorNeutralStroke2, #e0e0e0);
    display: flex;
    align-items: center;
    justify-content: space-between;
  }
}

/* ==================== Status Badges ==================== */

.cr-badge {
  display: inline-flex;
  align-items: center;
  padding: var(--spacingVerticalXXS, 2px) var(--spacingHorizontalS, 8px);
  border-radius: var(--borderRadiusMedium, 4px);
  font-family: var(--fontFamilyBase);
  font-size: var(--fontSizeBase200, 12px);
  font-weight: var(--fontWeightMedium, 500);

  &--success {
    background: var(--colorPaletteGreenBackground1, #dff6dd);
    color: var(--cr-status-success);
  }

  &--warning {
    background: var(--colorPaletteYellowBackground1, #fff4ce);
    color: var(--cr-status-warning);
  }

  &--error {
    background: var(--colorPaletteRedBackground1, #fde7e9);
    color: var(--cr-status-error);
  }

  &--info {
    background: var(--colorBrandBackground2, #ebf3fc);
    color: var(--cr-status-info);
  }

  &--muted {
    background: var(--colorNeutralBackground4, #f0f0f0);
    color: var(--cr-status-muted);
  }
}

/* State-specific badges */
.cr-badge--queued { @extend .cr-badge--muted; }
.cr-badge--running { @extend .cr-badge--warning; }
.cr-badge--succeeded { @extend .cr-badge--success; }
.cr-badge--failed { @extend .cr-badge--error; }
.cr-badge--canceled { @extend .cr-badge--muted; }

/* Severity-specific badges */
.cr-badge--severity-low { @extend .cr-badge--muted; }
.cr-badge--severity-medium { @extend .cr-badge--warning; }
.cr-badge--severity-high {
  background: var(--colorPaletteOrangeBackground1, #ffede0);
  color: var(--cr-severity-high);
}
.cr-badge--severity-critical { @extend .cr-badge--error; }

/* ==================== Control Room Buttons ==================== */

.cr-btn {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  gap: var(--spacingHorizontalS, 8px);
  padding: var(--spacingVerticalS, 8px) var(--spacingHorizontalM, 12px);
  border-radius: var(--borderRadiusMedium, 4px);
  font-family: var(--fontFamilyBase);
  font-size: var(--fontSizeBase300, 14px);
  font-weight: var(--fontWeightMedium, 500);
  border: 1px solid transparent;
  cursor: pointer;
  transition: all var(--durationFast, 150ms) var(--curveEasyEase);

  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }

  &--primary {
    background: var(--colorBrandBackground, #0f6cbd);
    color: var(--colorNeutralForegroundOnBrand, #ffffff);
    border-color: var(--colorBrandBackground, #0f6cbd);

    &:hover:not(:disabled) {
      background: var(--colorBrandBackgroundHover, #115ea3);
    }

    &:active:not(:disabled) {
      background: var(--colorBrandBackgroundPressed, #0a4d82);
    }
  }

  &--secondary {
    background: var(--colorNeutralBackground1, #ffffff);
    color: var(--colorNeutralForeground1, #242424);
    border-color: var(--colorNeutralStroke1, #d1d1d1);

    &:hover:not(:disabled) {
      background: var(--colorNeutralBackground1Hover, #f5f5f5);
    }

    &:active:not(:disabled) {
      background: var(--colorNeutralBackground1Pressed, #e8e8e8);
    }
  }

  &--danger {
    background: var(--colorPaletteRedBackground3, #c42b1c);
    color: #ffffff;

    &:hover:not(:disabled) {
      background: var(--colorPaletteRedBackground3, #a52714);
    }
  }

  &--icon {
    padding: var(--spacingVerticalS, 8px);
    border-radius: var(--borderRadiusCircular, 10000px);
  }
}

/* ==================== Pipeline Timeline ==================== */

.cr-timeline {
  display: flex;
  flex-direction: column;
  gap: 0;

  &__item {
    display: flex;
    position: relative;
    padding-left: var(--spacingHorizontalXL, 20px);

    &::before {
      content: '';
      position: absolute;
      left: 7px;
      top: 24px;
      bottom: 0;
      width: 2px;
      background: var(--colorNeutralStroke2, #e0e0e0);
    }

    &:last-child::before {
      display: none;
    }
  }

  &__marker {
    position: absolute;
    left: 0;
    top: 4px;
    width: 16px;
    height: 16px;
    border-radius: var(--borderRadiusCircular, 10000px);
    background: var(--colorNeutralBackground1, #ffffff);
    border: 2px solid var(--colorNeutralStroke1, #d1d1d1);

    &--success { border-color: var(--cr-status-success); background: var(--cr-status-success); }
    &--warning { border-color: var(--cr-status-warning); background: var(--cr-status-warning); }
    &--error { border-color: var(--cr-status-error); background: var(--cr-status-error); }
    &--info { border-color: var(--cr-status-info); background: var(--cr-status-info); }
  }

  &__content {
    flex: 1;
    padding-bottom: var(--spacingVerticalL, 16px);
  }

  &__time {
    font-size: var(--fontSizeBase200, 12px);
    color: var(--colorNeutralForeground3, #616161);
    margin-bottom: var(--spacingVerticalXS, 4px);
  }

  &__message {
    font-size: var(--fontSizeBase300, 14px);
    color: var(--colorNeutralForeground1, #242424);
  }
}

/* ==================== Metrics Display ==================== */

.cr-metric {
  display: flex;
  flex-direction: column;

  &__value {
    font-family: var(--fontFamilyNumeric, var(--fontFamilyBase));
    font-size: var(--fontSizeHero700, 28px);
    font-weight: var(--fontWeightSemibold, 600);
    color: var(--colorNeutralForeground1, #242424);
    line-height: 1.2;
  }

  &__label {
    font-size: var(--fontSizeBase200, 12px);
    color: var(--colorNeutralForeground3, #616161);
    margin-top: var(--spacingVerticalXS, 4px);
  }

  &__trend {
    display: inline-flex;
    align-items: center;
    font-size: var(--fontSizeBase200, 12px);
    margin-top: var(--spacingVerticalXS, 4px);

    &--up { color: var(--cr-status-success); }
    &--down { color: var(--cr-status-error); }
    &--neutral { color: var(--cr-status-muted); }
  }
}

/* ==================== Progress Indicators ==================== */

.cr-progress {
  display: flex;
  flex-direction: column;
  gap: var(--spacingVerticalXS, 4px);

  &__bar {
    height: 8px;
    background: var(--colorNeutralBackground4, #f0f0f0);
    border-radius: var(--borderRadiusCircular, 10000px);
    overflow: hidden;
  }

  &__fill {
    height: 100%;
    background: var(--colorBrandBackground, #0f6cbd);
    border-radius: var(--borderRadiusCircular, 10000px);
    transition: width var(--durationNormal, 200ms) var(--curveEasyEase);
  }

  &__label {
    display: flex;
    justify-content: space-between;
    font-size: var(--fontSizeBase200, 12px);
    color: var(--colorNeutralForeground3, #616161);
  }

  /* State variants */
  &--success .cr-progress__fill { background: var(--cr-status-success); }
  &--warning .cr-progress__fill { background: var(--cr-status-warning); }
  &--error .cr-progress__fill { background: var(--cr-status-error); }
}

/* ==================== Empty State ==================== */

.cr-empty {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  padding: var(--spacingVerticalXXXL, 32px);
  text-align: center;

  &__icon {
    font-size: 48px;
    color: var(--colorNeutralForeground4, #707070);
    margin-bottom: var(--spacingVerticalM, 12px);
  }

  &__title {
    font-size: var(--fontSizeBase400, 16px);
    font-weight: var(--fontWeightSemibold, 600);
    color: var(--colorNeutralForeground1, #242424);
    margin-bottom: var(--spacingVerticalS, 8px);
  }

  &__description {
    font-size: var(--fontSizeBase300, 14px);
    color: var(--colorNeutralForeground3, #616161);
    max-width: 300px;
  }

  &__action {
    margin-top: var(--spacingVerticalL, 16px);
  }
}

/* ==================== Odoo List View Enhancements ==================== */

.o_control_room {
  /* State row decorations */
  .o_data_row {
    &[data-state="queued"] { --row-accent: var(--cr-state-queued); }
    &[data-state="running"] { --row-accent: var(--cr-state-running); }
    &[data-state="succeeded"] { --row-accent: var(--cr-state-succeeded); }
    &[data-state="failed"] { --row-accent: var(--cr-state-failed); }
    &[data-state="canceled"] { --row-accent: var(--cr-state-canceled); }
  }

  /* Badge field styling */
  .o_badge {
    font-family: var(--fontFamilyBase);
    font-weight: var(--fontWeightMedium, 500);
    border-radius: var(--borderRadiusMedium, 4px);
  }
}

/* ==================== Form View Enhancements ==================== */

.o_form_view {
  /* Status bar styling */
  .o_statusbar_status {
    .btn {
      border-radius: var(--borderRadiusMedium, 4px);
      font-weight: var(--fontWeightMedium, 500);
    }
  }

  /* Header buttons */
  .o_form_buttons_edit,
  .o_form_buttons_view {
    .btn-primary {
      background: var(--colorBrandBackground, #0f6cbd);
      border-color: var(--colorBrandBackground, #0f6cbd);

      &:hover {
        background: var(--colorBrandBackgroundHover, #115ea3);
        border-color: var(--colorBrandBackgroundHover, #115ea3);
      }
    }
  }
}

/* ==================== Kanban View Enhancements ==================== */

.o_kanban_view {
  .o_kanban_record {
    border-radius: var(--borderRadiusLarge, 6px);
    border: 1px solid var(--colorNeutralStroke1, #d1d1d1);

    &:hover {
      box-shadow: var(--shadow8, 0 4px 8px rgba(0, 0, 0, 0.08));
    }
  }
}

/* ==================== Ace Editor JSON Styling ==================== */

.ace_editor {
  font-family: var(--fontFamilyMonospace, monospace) !important;
  font-size: var(--fontSizeBase300, 14px) !important;
  border-radius: var(--borderRadiusMedium, 4px);
  border: 1px solid var(--colorNeutralStroke1, #d1d1d1);
}
