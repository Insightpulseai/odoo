<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <!-- Project Form View Extension for CES Fields -->
    <record id="view_project_form_ces" model="ir.ui.view">
        <field name="name">project.project.form.ces</field>
        <field name="model">project.project</field>
        <field name="inherit_id" ref="project.edit_project"/>
        <field name="priority">50</field>
        <field name="arch" type="xml">
            <xpath expr="//page[@name='settings']" position="before">
                <page string="CES Campaign" name="ces_campaign">
                    <group>
                        <group string="Campaign Info">
                            <field name="ces_campaign_id"/>
                            <field name="ces_campaign_type"/>
                            <field name="ces_brand"/>
                            <field name="ces_client"/>
                            <field name="ces_agency"/>
                            <field name="ces_is_flagship"/>
                            <field name="ces_is_awards_entry"/>
                        </group>
                        <group string="Flight Dates">
                            <field name="ces_start_date"/>
                            <field name="ces_end_date"/>
                        </group>
                    </group>
                    <group>
                        <group string="Media Mix">
                            <field name="ces_media_channels" widget="many2many_tags"/>
                            <field name="ces_media_mix"/>
                        </group>
                        <group string="Budget">
                            <field name="currency_id" invisible="1"/>
                            <field name="ces_budget_total"/>
                            <field name="ces_production_budget"/>
                            <field name="ces_media_budget"/>
                            <field name="ces_fee_budget"/>
                        </group>
                    </group>
                    <group>
                        <group string="KPIs">
                            <field name="ces_kpi_reach"/>
                            <field name="ces_kpi_engagement"/>
                        </group>
                    </group>
                    <group>
                        <field name="ces_notes" placeholder="Campaign notes..."/>
                    </group>
                </page>
            </xpath>
        </field>
    </record>

    <!-- Project List View Extension -->
    <record id="view_project_tree_ces" model="ir.ui.view">
        <field name="name">project.project.tree.ces</field>
        <field name="model">project.project</field>
        <field name="inherit_id" ref="project.view_project"/>
        <field name="priority">50</field>
        <field name="arch" type="xml">
            <xpath expr="//field[@name='partner_id']" position="after">
                <field name="ces_campaign_id" optional="hide"/>
                <field name="ces_brand" optional="hide"/>
                <field name="ces_client" optional="hide"/>
                <field name="ces_campaign_type" optional="hide"/>
                <field name="ces_is_flagship" optional="hide"/>
            </xpath>
        </field>
    </record>

    <!-- Project Search View Extension -->
    <record id="view_project_search_ces" model="ir.ui.view">
        <field name="name">project.project.search.ces</field>
        <field name="model">project.project</field>
        <field name="inherit_id" ref="project.view_project_project_filter"/>
        <field name="priority">50</field>
        <field name="arch" type="xml">
            <xpath expr="//filter[@name='my_projects']" position="after">
                <separator/>
                <filter string="CES Campaigns" name="ces_campaigns"
                        domain="[('ces_campaign_id', '!=', False)]"/>
                <filter string="Flagship Campaigns" name="flagship"
                        domain="[('ces_is_flagship', '=', True)]"/>
                <filter string="Awards Entries" name="awards"
                        domain="[('ces_is_awards_entry', '=', True)]"/>
            </xpath>
            <xpath expr="//group" position="inside">
                <filter string="Campaign Type" name="group_campaign_type"
                        context="{'group_by': 'ces_campaign_type'}"/>
                <filter string="Brand" name="group_brand"
                        context="{'group_by': 'ces_brand'}"/>
                <filter string="Client" name="group_client"
                        context="{'group_by': 'ces_client'}"/>
                <filter string="Agency" name="group_agency"
                        context="{'group_by': 'ces_agency'}"/>
            </xpath>
        </field>
    </record>

    <!-- CES Campaigns Action -->
    <record id="action_ces_campaigns" model="ir.actions.act_window">
        <field name="name">CES Campaigns</field>
        <field name="res_model">project.project</field>
        <field name="view_mode">kanban,tree,form</field>
        <field name="domain">[('ces_campaign_id', '!=', False)]</field>
        <field name="context">{'search_default_ces_campaigns': 1}</field>
        <field name="help" type="html">
            <p class="o_view_nocontent_smiling_face">
                Create your first CES campaign
            </p>
            <p>
                Track creative campaigns with brand, client, and media mix information for CES analytics.
            </p>
        </field>
    </record>

    <!-- Media Channel List View -->
    <record id="view_ces_media_channel_tree" model="ir.ui.view">
        <field name="name">ces.media.channel.tree</field>
        <field name="model">ces.media.channel</field>
        <field name="arch" type="xml">
            <tree string="Media Channels" editable="bottom">
                <field name="sequence" widget="handle"/>
                <field name="code"/>
                <field name="name"/>
                <field name="channel_type"/>
                <field name="active"/>
            </tree>
        </field>
    </record>

    <!-- Media Channel Action -->
    <record id="action_ces_media_channels" model="ir.actions.act_window">
        <field name="name">Media Channels</field>
        <field name="res_model">ces.media.channel</field>
        <field name="view_mode">tree</field>
    </record>

    <!-- Menu Items -->
    <menuitem id="menu_ces_root"
              name="CES Media"
              sequence="30"
              web_icon="ipai_vertical_media,static/description/icon.png"/>

    <menuitem id="menu_ces_campaigns"
              name="Campaigns"
              parent="menu_ces_root"
              action="action_ces_campaigns"
              sequence="10"/>

    <menuitem id="menu_ces_configuration"
              name="Configuration"
              parent="menu_ces_root"
              sequence="90"/>

    <menuitem id="menu_ces_media_channels"
              name="Media Channels"
              parent="menu_ces_configuration"
              action="action_ces_media_channels"
              sequence="10"/>
</odoo>
