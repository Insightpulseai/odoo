<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data noupdate="1">

        <!-- ============================================================================ -->
        <!-- BIR Deadline Reminder System - Cron Jobs -->
        <!-- ============================================================================ -->
        <!-- Purpose: Automated reminders for BIR filing deadlines -->
        <!-- Schedule: 9AM & 5PM on due date, daily nudges when overdue -->
        <!-- Integration: n8n + Mattermost -->
        <!-- Date: 2025-12-28 -->
        <!-- ============================================================================ -->

        <!-- Cron Job 1: Due Date 9AM Reminder -->
        <record id="cron_bir_reminder_9am" model="ir.cron">
            <field name="name">BIR Deadline Reminder - 9AM</field>
            <field name="model_id" ref="model_ipai_bir_form_schedule"/>
            <field name="state">code</field>
            <field name="code">model.action_send_due_date_9am_reminder()</field>
            <field name="interval_number">1</field>
            <field name="interval_type">days</field>
            <field name="doall">False</field>
            <field name="nextcall" eval="(DateTime.now() + timedelta(days=1)).replace(hour=9, minute=0, second=0)"/>
            <field name="priority">10</field>
            <field name="active">True</field>
        </record>

        <!-- Cron Job 2: Due Date 5PM Reminder -->
        <record id="cron_bir_reminder_5pm" model="ir.cron">
            <field name="name">BIR Deadline Reminder - 5PM</field>
            <field name="model_id" ref="model_ipai_bir_form_schedule"/>
            <field name="state">code</field>
            <field name="code">model.action_send_due_date_5pm_reminder()</field>
            <field name="interval_number">1</field>
            <field name="interval_type">days</field>
            <field name="doall">False</field>
            <field name="nextcall" eval="(DateTime.now() + timedelta(days=1)).replace(hour=17, minute=0, second=0)"/>
            <field name="priority">10</field>
            <field name="active">True</field>
        </record>

        <!-- Cron Job 3: Overdue Daily Nudge -->
        <record id="cron_bir_overdue_nudge" model="ir.cron">
            <field name="name">BIR Overdue Daily Nudge</field>
            <field name="model_id" ref="model_ipai_bir_form_schedule"/>
            <field name="state">code</field>
            <field name="code">model.action_send_overdue_daily_nudge()</field>
            <field name="interval_number">1</field>
            <field name="interval_type">days</field>
            <field name="doall">False</field>
            <field name="nextcall" eval="(DateTime.now() + timedelta(days=1)).replace(hour=10, minute=0, second=0)"/>
            <field name="priority">10</field>
            <field name="active">True</field>
        </record>

        <!-- System Parameter: Mattermost Webhook URL -->
        <record id="param_mattermost_webhook" model="ir.config_parameter">
            <field name="key">bir.reminder.mattermost.webhook</field>
            <field name="value">https://mattermost.insightpulseai.net/hooks/REPLACE_WITH_ACTUAL_WEBHOOK_ID</field>
        </record>

        <!-- System Parameter: n8n Webhook URL -->
        <record id="param_n8n_webhook_reminder" model="ir.config_parameter">
            <field name="key">bir.reminder.n8n.webhook</field>
            <field name="value">https://ipa.insightpulseai.net/webhook/bir-reminder</field>
        </record>

        <record id="param_n8n_webhook_overdue" model="ir.config_parameter">
            <field name="key">bir.overdue.n8n.webhook</field>
            <field name="value">https://ipa.insightpulseai.net/webhook/bir-overdue-nudge</field>
        </record>

    </data>
</odoo>
