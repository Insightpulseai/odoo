// ============================================================================
// IPAI ChatGPT-style Backend Overrides
// ============================================================================
// Maps design tokens onto Odoo web client components.
// All overrides scoped under .o_web_client to avoid affecting login/public pages.
//
// Organized by component for maintainability.
// Selectors are minimal and leverage Bootstrap/Odoo variable mappings from tokens.

@import "tokens";

// ============================================================================
// SCOPED BACKEND OVERRIDES
// ============================================================================
// Wrapped in .o_web_client to ensure styles only apply to authenticated backend.

.o_web_client {
  // --------------------------------------------------------------------------
  // GLOBAL TYPOGRAPHY & SURFACES
  // --------------------------------------------------------------------------

  font-family: $ipai-font-sans;
  color: $ipai-text;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;

  .o_action_manager {
    background: $ipai-surface-secondary;
  }

  // --------------------------------------------------------------------------
  // BUTTONS (scoped to avoid login page)
  // --------------------------------------------------------------------------

  .btn {
    border-radius: $ipai-btn-radius;
    font-weight: $ipai-btn-font-weight;
    transition: all $ipai-duration-fast $ipai-ease-default;
  }

  .btn-primary {
    background: $ipai-primary;
    border-color: $ipai-primary;

    &:hover,
    &:focus {
      background: $ipai-primary-800;
      border-color: $ipai-primary-800;
      box-shadow: $ipai-shadow-primary;
    }

    &:active {
      background: $ipai-primary-900;
      border-color: $ipai-primary-900;
    }
  }

  .btn-secondary {
    background: $ipai-surface;
    border-color: $ipai-border;
    color: $ipai-text;

    &:hover,
    &:focus {
      background: $ipai-neutral-100;
      border-color: $ipai-neutral-300;
    }
  }

  .btn-outline-primary {
    color: $ipai-primary;
    border-color: $ipai-primary;

    &:hover,
    &:focus {
      background: $ipai-primary-50;
      color: $ipai-primary-800;
    }
  }

  .btn-success {
    background: $ipai-success;
    border-color: $ipai-success;

    &:hover,
    &:focus {
      background: $ipai-success-700;
      border-color: $ipai-success-700;
    }
  }

  .btn-danger {
    background: $ipai-danger;
    border-color: $ipai-danger;

    &:hover,
    &:focus {
      background: $ipai-danger-700;
      border-color: $ipai-danger-700;
    }
  }

  .btn-link {
    color: $ipai-primary;
    text-decoration: none;

    &:hover {
      color: $ipai-primary-800;
      text-decoration: underline;
    }
  }

  // --------------------------------------------------------------------------
  // FORM INPUTS (scoped to avoid login page)
  // --------------------------------------------------------------------------

  .form-control,
  .o_input,
  .o_field_widget input,
  .o_field_widget textarea,
  .o_field_widget select {
    border-radius: $ipai-input-radius;
    border-color: $ipai-input-border;
    transition: border-color $ipai-duration-fast $ipai-ease-default,
      box-shadow $ipai-duration-fast $ipai-ease-default;

    &:focus {
      border-color: $ipai-input-focus-border;
      box-shadow: 0 0 0 3px $ipai-input-focus-ring;
      outline: none;
    }

    &::placeholder {
      color: $ipai-neutral-400;
    }
  }

  .form-select,
  select.o_input {
    border-radius: $ipai-input-radius;
    border-color: $ipai-input-border;

    &:focus {
      border-color: $ipai-input-focus-border;
      box-shadow: 0 0 0 3px $ipai-input-focus-ring;
    }
  }

  // --------------------------------------------------------------------------
  // DROPDOWNS & MENUS (scoped)
  // --------------------------------------------------------------------------

  .dropdown-menu {
    border-radius: $ipai-radius-md;
    border: 1px solid $ipai-border;
    box-shadow: $ipai-shadow-lg;
    padding: $ipai-space-1;

    .dropdown-item {
      border-radius: $ipai-radius-sm;
      padding: $ipai-space-2 $ipai-space-3;
      color: $ipai-text;
      transition: background $ipai-duration-fast $ipai-ease-default;

      &:hover,
      &:focus {
        background: $ipai-neutral-100;
        color: $ipai-text;
      }

      &.active,
      &:active {
        background: $ipai-primary-50;
        color: $ipai-primary-800;
      }
    }

    .dropdown-divider {
      border-color: $ipai-border;
      margin: $ipai-space-1 0;
    }
  }

  // --------------------------------------------------------------------------
  // MODALS & DIALOGS (scoped)
  // --------------------------------------------------------------------------

  .modal-content {
    border-radius: $ipai-radius-lg;
    border: none;
    box-shadow: $ipai-shadow-xl;

    .modal-header {
      border-bottom: 1px solid $ipai-border;
      padding: $ipai-space-4;

      .modal-title {
        font-weight: $ipai-font-semibold;
      }
    }

    .modal-body {
      padding: $ipai-space-4;
    }

    .modal-footer {
      border-top: 1px solid $ipai-border;
      padding: $ipai-space-3 $ipai-space-4;
      gap: $ipai-space-2;
    }
  }

  // --------------------------------------------------------------------------
  // CARDS (scoped)
  // --------------------------------------------------------------------------

  .card {
    border-radius: $ipai-card-radius;
    border: 1px solid $ipai-card-border;
    background: $ipai-card-bg;
    box-shadow: $ipai-card-shadow;
  }

  // --------------------------------------------------------------------------
  // SCROLLBARS (Webkit, scoped)
  // --------------------------------------------------------------------------

  ::-webkit-scrollbar {
    width: 8px;
    height: 8px;
  }

  ::-webkit-scrollbar-track {
    background: $ipai-neutral-100;
  }

  ::-webkit-scrollbar-thumb {
    background: $ipai-neutral-300;
    border-radius: $ipai-radius-full;

    &:hover {
      background: $ipai-neutral-400;
    }
  }
}

// ============================================================================
// ODOO-SPECIFIC SELECTORS (inherently scoped to backend)
// ============================================================================
// These .o_* selectors only exist in the web client, so no extra scoping needed.

// --------------------------------------------------------------------------
// TOP NAVBAR
// --------------------------------------------------------------------------

.o_main_navbar {
  background: $ipai-navbar-bg !important;
  border-bottom: 1px solid rgba(255, 255, 255, 0.12);
  height: $ipai-navbar-height;

  .o_menu_brand {
    color: $ipai-navbar-text !important;
    font-weight: $ipai-font-semibold;
  }

  .o_menu_sections {
    a,
    button {
      color: rgba(255, 255, 255, 0.85) !important;
      transition: color $ipai-duration-fast $ipai-ease-default;

      &:hover {
        color: $ipai-navbar-text !important;
        background: rgba(255, 255, 255, 0.1);
      }
    }
  }

  .o_user_menu,
  .o_navbar_apps_menu {
    a,
    button {
      color: $ipai-navbar-text !important;
    }
  }

  .o_menu_systray .o_navbar_item {
    color: $ipai-navbar-text !important;
  }
}

.o_navbar_apps_menu .dropdown-menu {
  border-radius: $ipai-radius-md;
  box-shadow: $ipai-shadow-lg;
  border: 1px solid $ipai-border;
}

// --------------------------------------------------------------------------
// CONTROL PANEL (Search/Filter Bar)
// --------------------------------------------------------------------------

.o_control_panel {
  background: $ipai-surface;
  border-bottom: 1px solid $ipai-border;
  padding: $ipai-space-3 $ipai-space-4;

  .o_cp_top,
  .o_cp_bottom {
    gap: $ipai-gap;
  }

  .breadcrumb {
    .breadcrumb-item {
      color: $ipai-muted;

      &.active {
        color: $ipai-text;
        font-weight: $ipai-font-medium;
      }

      a {
        color: $ipai-primary;

        &:hover {
          color: $ipai-primary-800;
        }
      }
    }
  }
}

.o_cp_searchview {
  border-radius: $ipai-radius-md;
  border: 1px solid $ipai-border;
  background: $ipai-surface;

  &:focus-within {
    border-color: $ipai-input-focus-border;
    box-shadow: 0 0 0 3px $ipai-input-focus-ring;
  }
}

.o_filter_menu,
.o_group_by_menu,
.o_favorite_menu {
  .dropdown-toggle {
    border-radius: $ipai-radius-sm;
    border: 1px solid $ipai-border;
    background: $ipai-surface;

    &:hover {
      background: $ipai-neutral-50;
    }
  }
}

// --------------------------------------------------------------------------
// KANBAN VIEW
// --------------------------------------------------------------------------

.o_kanban_view {
  background: $ipai-surface-secondary;
  gap: $ipai-kanban-column-gap;
}

.o_kanban_record {
  border-radius: $ipai-kanban-card-radius;
  border: 1px solid $ipai-card-border;
  background: $ipai-card-bg;
  box-shadow: $ipai-shadow-sm;
  transition: box-shadow $ipai-duration-fast $ipai-ease-default,
    transform $ipai-duration-fast $ipai-ease-default;

  &:hover {
    box-shadow: $ipai-shadow-md;
    transform: translateY(-1px);
  }
}

.o_kanban_group {
  .o_kanban_header {
    font-weight: $ipai-font-semibold;
    color: $ipai-text;
  }
}

// --------------------------------------------------------------------------
// LIST VIEW / TABLES
// --------------------------------------------------------------------------

.o_list_view {
  thead th {
    background: $ipai-table-header-bg;
    color: $ipai-table-header-text;
    font-weight: $ipai-font-semibold;
    font-size: $ipai-text-sm;
    text-transform: uppercase;
    letter-spacing: 0.025em;
    border-bottom: 2px solid $ipai-border;
  }

  tbody tr {
    transition: background $ipai-duration-fast $ipai-ease-default;

    &:hover {
      background: $ipai-table-row-hover;
    }
  }

  td,
  th {
    border-color: $ipai-table-border;
  }
}

// --------------------------------------------------------------------------
// FORM VIEW
// --------------------------------------------------------------------------

.o_form_view {
  .o_form_sheet {
    border-radius: $ipai-card-radius;
    box-shadow: $ipai-shadow-sm;
    border: 1px solid $ipai-border;
    background: $ipai-surface;
  }

  .o_form_label {
    color: $ipai-text-secondary;
    font-weight: $ipai-font-medium;
  }

  .o_notebook {
    .nav-tabs {
      border-bottom: 1px solid $ipai-border;

      .nav-link {
        border-radius: $ipai-radius-sm $ipai-radius-sm 0 0;
        color: $ipai-muted;
        font-weight: $ipai-font-medium;

        &:hover {
          color: $ipai-text;
          border-color: transparent;
        }

        &.active {
          color: $ipai-primary;
          border-color: $ipai-border $ipai-border $ipai-surface;
          background: $ipai-surface;
        }
      }
    }
  }

  .o_statusbar_status {
    .o_arrow_button {
      border-radius: $ipai-radius-sm;

      &.btn-primary,
      &.o_arrow_button_current {
        background: $ipai-primary;
        color: $ipai-navbar-text;
      }
    }
  }
}

.o_form_sheet_bg .o_form_sheet {
  border-radius: $ipai-card-radius;
  border: 1px solid $ipai-card-border;
  background: $ipai-card-bg;
  box-shadow: $ipai-card-shadow;
}

// --------------------------------------------------------------------------
// PILLS & TAGS
// --------------------------------------------------------------------------

.o_tag,
.o_badge {
  border-radius: $ipai-tag-radius;
  padding: $ipai-tag-padding-y $ipai-tag-padding-x;
  font-size: $ipai-tag-font-size;
  font-weight: $ipai-font-medium;
  border: 1px solid $ipai-border;
  background: $ipai-surface;
  color: $ipai-text;
}

// Colored tag variants (Odoo uses .bg-* and .text-bg-*)
.o_tag,
.o_badge,
.badge {
  &.bg-primary,
  &.text-bg-primary {
    background: $ipai-primary-100 !important;
    color: $ipai-primary-800 !important;
    border-color: $ipai-primary-200 !important;
  }

  &.bg-success,
  &.text-bg-success {
    background: $ipai-success-100 !important;
    color: $ipai-success-700 !important;
    border-color: $ipai-success-600 !important;
  }

  &.bg-warning,
  &.text-bg-warning {
    background: $ipai-warning-100 !important;
    color: $ipai-warning-700 !important;
    border-color: $ipai-warning-600 !important;
  }

  &.bg-danger,
  &.text-bg-danger {
    background: $ipai-danger-100 !important;
    color: $ipai-danger-700 !important;
    border-color: $ipai-danger-600 !important;
  }

  &.bg-info,
  &.text-bg-info {
    background: $ipai-info-100 !important;
    color: $ipai-info-700 !important;
    border-color: $ipai-info-600 !important;
  }
}

// --------------------------------------------------------------------------
// CHATTER / ACTIVITY
// --------------------------------------------------------------------------

.o_ChatterContainer {
  .o_Chatter {
    background: $ipai-surface-secondary;
    border-left: 1px solid $ipai-border;
  }
}

.o_Message {
  border-radius: $ipai-radius-md;
  padding: $ipai-space-3;

  &:hover {
    background: $ipai-neutral-50;
  }
}

// --------------------------------------------------------------------------
// CALENDAR VIEW
// --------------------------------------------------------------------------

.o_calendar_view {
  .fc-header-toolbar {
    .fc-button {
      border-radius: $ipai-radius-sm;
    }

    .fc-button-primary {
      background: $ipai-primary;
      border-color: $ipai-primary;

      &:hover {
        background: $ipai-primary-800;
        border-color: $ipai-primary-800;
      }
    }
  }

  .fc-event {
    border-radius: $ipai-radius-sm;
    border: none;
    padding: 2px $ipai-space-2;
  }
}

// --------------------------------------------------------------------------
// PIVOT & GRAPH VIEWS
// --------------------------------------------------------------------------

.o_pivot {
  .o_pivot_header_cell_closed,
  .o_pivot_header_cell_opened {
    background: $ipai-neutral-100;
    font-weight: $ipai-font-medium;
  }
}

.o_graph_view {
  .o_graph_canvas_container {
    background: $ipai-surface;
    border-radius: $ipai-radius-md;
    padding: $ipai-space-4;
  }
}

// --------------------------------------------------------------------------
// SIDEBAR / APP MENU
// --------------------------------------------------------------------------

.o_main_sidebar,
.o_menu_brand_icon {
  background: $ipai-sidebar-bg;
}

// --------------------------------------------------------------------------
// EMPTY STATES
// --------------------------------------------------------------------------

.o_nocontent_help {
  text-align: center;
  padding: $ipai-space-8;
  color: $ipai-muted;

  .o_nocontent_help_content {
    max-width: 400px;
    margin: 0 auto;
  }

  p {
    margin-bottom: $ipai-space-4;
  }
}

// --------------------------------------------------------------------------
// ACCESSIBILITY: Focus visible
// --------------------------------------------------------------------------

.o_web_client :focus-visible {
  outline: 2px solid $ipai-primary;
  outline-offset: 2px;
}
