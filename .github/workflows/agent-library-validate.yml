name: agent-library-validate

on:
  pull_request:
  push:
    branches: [main]

jobs:
  validate:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4

      - name: Set up Python
        uses: actions/setup-python@v5
        with:
          python-version: "3.11"

      - name: Install deps
        run: |
          python -m pip install --upgrade pip
          python -m pip install -r agent-library/ci/requirements.txt

      - name: Validate dist outputs if present
        run: |
          if [ -f agent-library/dist/capability_atoms.yaml ] && [ -f agent-library/dist/ux_patterns.yaml ]; then
            python agent-library/scripts/validate_outputs.py --dist agent-library/dist --schemas agent-library/schemas
          else
            echo "No dist outputs committed yet; skipping schema validation."
          fi
