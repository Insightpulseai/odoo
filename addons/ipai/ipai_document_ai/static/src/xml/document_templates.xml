<?xml version="1.0" encoding="UTF-8"?>
<templates xml:space="preserve">

    <!-- Document Upload Widget Template -->
    <t t-name="ipai_document_ai.DocumentUploadWidget" owl="1">
        <div class="o_ipai_document_upload">
            <!-- Upload Zone -->
            <div t-ref="dropZone" t-att-class="dropZoneClass" t-on-click="onClickUpload">
                <t t-if="state.isUploading">
                    <div class="o_ipai_processing">
                        <div class="o_spinner"/>
                        <span>Uploading document...</span>
                    </div>
                </t>
                <t t-elif="state.isProcessing">
                    <div class="o_ipai_processing">
                        <div class="o_spinner"/>
                        <span>Processing with OCR...</span>
                    </div>
                </t>
                <t t-else="">
                    <div class="o_icon">
                        <i class="fa fa-cloud-upload fa-3x"/>
                    </div>
                    <div class="o_text">
                        <p>Drag and drop a document here</p>
                        <p class="text-muted">or click to browse</p>
                        <p class="text-muted small">Supported: PDF, JPG, PNG (max 25MB)</p>
                    </div>
                </t>
            </div>

            <!-- Hidden file input -->
            <input
                t-ref="fileInput"
                type="file"
                class="d-none"
                accept=".pdf,.jpg,.jpeg,.png,.tiff"
                t-on-change="onFileChange"/>

            <!-- Error display -->
            <t t-if="state.error">
                <div class="alert alert-danger mt-3">
                    <i class="fa fa-exclamation-triangle me-2"/>
                    <span t-esc="state.error"/>
                </div>
            </t>
        </div>
    </t>

    <!-- Extracted Fields Display -->
    <t t-name="ipai_document_ai.ExtractedFields" owl="1">
        <div class="o_ipai_extracted_fields">
            <t t-foreach="props.fields" t-as="field" t-key="field.name">
                <div class="o_ipai_field_item">
                    <span class="o_ipai_field_label" t-esc="field.label"/>
                    <span class="o_ipai_field_value" t-esc="field.value"/>
                    <span class="o_ipai_field_confidence">
                        Confidence: <t t-esc="Math.round(field.confidence * 100)"/>%
                    </span>
                </div>
            </t>
        </div>
    </t>

    <!-- Confidence Badge -->
    <t t-name="ipai_document_ai.ConfidenceBadge" owl="1">
        <span t-attf-class="o_ipai_confidence_badge #{props.level}">
            <t t-if="props.level === 'high'">
                <i class="fa fa-check-circle me-1"/>
            </t>
            <t t-elif="props.level === 'medium'">
                <i class="fa fa-exclamation-circle me-1"/>
            </t>
            <t t-else="">
                <i class="fa fa-question-circle me-1"/>
            </t>
            <t t-esc="Math.round(props.value * 100)"/>%
        </span>
    </t>

    <!-- Review Panel -->
    <t t-name="ipai_document_ai.ReviewPanel" owl="1">
        <div class="o_ipai_review_panel">
            <div class="o_header">
                <span class="o_title">Review Extracted Data</span>
                <div class="o_actions">
                    <button class="btn btn-secondary btn-sm" t-on-click="onReject">
                        <i class="fa fa-times me-1"/>Reject
                    </button>
                    <button class="btn btn-primary btn-sm" t-on-click="onApply">
                        <i class="fa fa-check me-1"/>Apply to Record
                    </button>
                </div>
            </div>
            <t t-call="ipai_document_ai.ExtractedFields">
                <t t-set="fields" t-value="props.extractedFields"/>
            </t>
        </div>
    </t>

</templates>
