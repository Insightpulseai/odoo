# ============================================================================
# Odoo 18 CE - Environment Variables Template
# ============================================================================
# This file documents all environment variables for Odoo General Settings
# programmatic configuration.
#
# IMPORTANT SECRETS MANAGEMENT PATTERN (Supabase-native):
# ============================================================================
# 1. **NEVER** commit actual secrets to git (use .gitignore for .env.local)
# 2. Store secrets in **Supabase Edge Function secrets** (CLI, not UI):
#    ```bash
#    supabase functions secrets set \
#      ODOO_PASSWORD="<secret>" \
#      SMTP_PASSWORD="<secret>" \
#      OUTLOOK_CLIENT_SECRET="<secret>" \
#      GMAIL_CLIENT_SECRET="<secret>"
#    ```
# 3. In Edge Functions, read via `Deno.env.get("VAR_NAME")`
# 4. For ultra-sensitive secrets, use **Supabase Vault** (if enabled)
# 5. Non-sensitive config can be in .env.local (gitignored)
# ============================================================================

# ----------------------------------------------------------------------------
# SUPABASE CONFIGURATION
# ----------------------------------------------------------------------------
# Stored in Supabase Edge Function secrets
SUPABASE_URL="https://spdtwktxdalcfigzeqrz.supabase.co"
SUPABASE_ANON_KEY="<supabase-anon-key>"
SUPABASE_SERVICE_ROLE_KEY="<supabase-service-role-key>"  # SECRET - Vault only

# Seed run token (for securing Edge Function invocation)
SEED_RUN_TOKEN="<long-random-token>"  # SECRET - generate with: openssl rand -hex 32

# ----------------------------------------------------------------------------
# ODOO CONFIGURATION
# ----------------------------------------------------------------------------
# Stored in Supabase Edge Function secrets or Vault
ODOO_URL="https://erp.insightpulseai.net"
ODOO_DB="production"
ODOO_USER="seed_bot@insightpulseai.com"  # Dedicated user for automation
ODOO_PASSWORD="<super-secret-password>"  # SECRET - Vault only

# Odoo database connection (for direct PostgreSQL access)
DB_HOST="localhost"
DB_PORT="5432"
DB_USER="odoo"
DB_PASSWORD="<db-password>"  # SECRET - Vault or function secrets
DB_NAME="odoo"

# Odoo admin master password (for database operations)
ADMIN_PASSWD="<master-password>"  # SECRET - Vault only

# ----------------------------------------------------------------------------
# EMAIL COMMUNICATION - SMTP (MAILGUN)
# ----------------------------------------------------------------------------
# Non-sensitive config (can be in .env.local)
EMAIL_FROM="info@insightpulseai.net"
SMTP_SERVER="smtp.mailgun.org"
SMTP_PORT="587"
SMTP_SSL="starttls"
SMTP_USER="postmaster@mg.insightpulseai.net"

# SECRET - Store in Supabase function secrets or Vault
SMTP_PASSWORD="<mailgun-smtp-password>"

# Mailjet API (if using OCA mail_server_mailjet)
MAILJET_API_KEY="<mailjet-api-key>"  # SECRET
MAILJET_SECRET_KEY="<mailjet-secret-key>"  # SECRET

# DNS configuration (non-sensitive, for documentation)
MAIL_CATCHALL_DOMAIN="mg.insightpulseai.net"
MAIL_CATCHALL_ALIAS="catchall"
MAIL_BOUNCE_ALIAS="bounce"

# ----------------------------------------------------------------------------
# OAUTH PROVIDERS
# ----------------------------------------------------------------------------
# Outlook 365 (Azure AD)
OUTLOOK_CLIENT_ID="<azure-application-client-id>"  # Can be non-secret
OUTLOOK_CLIENT_SECRET="<azure-client-secret>"  # SECRET - Vault or function secrets
OUTLOOK_TENANT_ID="<azure-tenant-id>"  # Can be non-secret

# Gmail (Google Cloud)
GMAIL_CLIENT_ID="<google-oauth-client-id>"  # Can be non-secret
GMAIL_CLIENT_SECRET="<google-oauth-client-secret>"  # SECRET - Vault or function secrets

# Facebook OAuth
FACEBOOK_CLIENT_ID="<facebook-app-id>"  # Can be non-secret
FACEBOOK_CLIENT_SECRET="<facebook-app-secret>"  # SECRET - Vault or function secrets

# ----------------------------------------------------------------------------
# INTEGRATIONS - THIRD-PARTY APIS
# ----------------------------------------------------------------------------
# Unsplash (image library)
# Free tier: 50 requests/hour
UNSPLASH_ACCESS_KEY="<unsplash-api-key>"  # Semi-secret (low risk)

# Google Translate
# Cost: $20 per 1M characters
GOOGLE_TRANSLATE_API_KEY="<google-translate-api-key>"  # SECRET

# Google Maps
# Free tier: $200 credit/month
GOOGLE_MAPS_API_KEY="<google-maps-api-key>"  # SECRET (restrict by HTTP referrer)

# ----------------------------------------------------------------------------
# CLOUD STORAGE
# ----------------------------------------------------------------------------
# AWS S3 / S3-Compatible (DigitalOcean Spaces, Backblaze B2, etc.)
S3_ENDPOINT="https://sgp1.digitaloceanspaces.com"  # DigitalOcean Spaces
S3_ACCESS_KEY="<s3-access-key>"  # SECRET - Vault or function secrets
S3_SECRET_KEY="<s3-secret-key>"  # SECRET - Vault or function secrets
S3_BUCKET="odoo-attachments"
S3_REGION="sgp1"

# Google Cloud Storage (GCS)
GCS_BUCKET="odoo-attachments-gcs"
GCS_SERVICE_ACCOUNT_JSON="<base64-encoded-service-account-json>"  # SECRET - Vault only

# Azure Blob Storage
AZURE_STORAGE_ACCOUNT="odooattachments"
AZURE_APPLICATION_ID="<azure-app-id>"
AZURE_TENANT_ID="<azure-tenant-id>"
AZURE_CLIENT_SECRET="<azure-client-secret>"  # SECRET - Vault or function secrets
AZURE_CONTAINER="attachments"

# ----------------------------------------------------------------------------
# IOT CONFIGURATION (ipai_iot_bridge)
# ----------------------------------------------------------------------------
# Self-hosted IoT gateway URL
IOT_BOX_URL="http://192.168.1.100:8069"  # Optional, local network

# IoT gateway authentication
IOT_BOX_TOKEN="<iot-gateway-jwt-token>"  # SECRET - generated by ipai_iot_bridge

# ----------------------------------------------------------------------------
# DEVELOPER MODE
# ----------------------------------------------------------------------------
# Enable developer mode (0=disabled, 1=enabled)
WEB_DEBUG="0"

# ----------------------------------------------------------------------------
# PERFORMANCE & RESOURCES
# ----------------------------------------------------------------------------
WORKERS="4"
MAX_CRON_THREADS="2"
LIMIT_MEMORY_HARD="2684354560"  # 2.5 GB
LIMIT_MEMORY_SOFT="2147483648"  # 2 GB

# ----------------------------------------------------------------------------
# LOGGING
# ----------------------------------------------------------------------------
LOG_LEVEL="info"  # debug, info, warn, error, critical
LOGFILE=""  # Empty for stdout, or /var/log/odoo/odoo.log

# ----------------------------------------------------------------------------
# SESSION STORAGE (REDIS)
# ----------------------------------------------------------------------------
# Recommended for production multi-worker setup
REDIS_HOST="localhost"
REDIS_PORT="6379"
REDIS_DB="1"
REDIS_PASSWORD="<redis-password>"  # SECRET - Vault or function secrets

# ----------------------------------------------------------------------------
# MODULES & PATHS
# ----------------------------------------------------------------------------
ADDONS_PATH="/mnt/extra-addons"
DATA_DIR="/var/lib/odoo"

# ============================================================================
# USAGE INSTRUCTIONS
# ============================================================================
#
# **LOCAL DEVELOPMENT**:
# 1. Copy this file to `.env.local`
# 2. Populate secrets (ask team for credentials)
# 3. Ensure `.env.local` is in .gitignore
# 4. Load variables: `source .env.local` or use direnv
#
# **SUPABASE EDGE FUNCTIONS (Production)**:
# 1. Set secrets via CLI (NEVER via UI or git):
#    ```bash
#    supabase functions secrets set \
#      SUPABASE_URL="https://spdtwktxdalcfigzeqrz.supabase.co" \
#      SUPABASE_SERVICE_ROLE_KEY="<key>" \
#      ODOO_URL="https://erp.insightpulseai.net" \
#      ODOO_DB="production" \
#      ODOO_USER="seed_bot@insightpulseai.com" \
#      ODOO_PASSWORD="<password>" \
#      SMTP_PASSWORD="<password>" \
#      OUTLOOK_CLIENT_SECRET="<secret>" \
#      GMAIL_CLIENT_SECRET="<secret>" \
#      SEED_RUN_TOKEN="<token>"
#    ```
#
# 2. In Edge Functions, read via:
#    ```typescript
#    const odooPassword = Deno.env.get("ODOO_PASSWORD") ?? "";
#    const supabaseKey = Deno.env.get("SUPABASE_SERVICE_ROLE_KEY")!;
#    ```
#
# 3. NEVER hardcode secrets in Edge Function code
#
# **SUPABASE VAULT (Optional, for high-security)**:
# If Vault is enabled, fetch secrets at runtime:
# ```typescript
# async function getVaultSecret(name: string): Promise<string> {
#   const vaultUrl = Deno.env.get("SUPABASE_VAULT_URL")!;
#   const token = Deno.env.get("SUPABASE_VAULT_TOKEN")!;
#   const res = await fetch(`${vaultUrl}/v1/secrets/${name}`, {
#     headers: { Authorization: `Bearer ${token}` }
#   });
#   const json = await res.json();
#   return json.value;
# }
#
# const odooPassword = await getVaultSecret("ODOO_PASSWORD");
# ```
#
# **GITHUB ACTIONS CI/CD**:
# Store secrets in GitHub Actions secrets (Settings > Secrets and variables > Actions)
# Access via: ${{ secrets.ODOO_PASSWORD }}
#
# **HASHICORP VAULT (Advanced)**:
# If using external Vault:
# 1. Store Odoo credentials in Vault KV: `vault kv put secret/odoo ...`
# 2. Create read-only policy: `vault policy write odoo-seed-policy ...`
# 3. Issue token: `vault token create -policy=odoo-seed-policy -ttl=1h`
# 4. Store token in Supabase function secrets: `VAULT_TOKEN`
# 5. Fetch at runtime from Vault API
#
# ============================================================================
# SECRETS HIERARCHY (from most secure to least secure)
# ============================================================================
# Tier 1: Supabase Vault (if enabled)
#   - ODOO_PASSWORD
#   - SMTP_PASSWORD
#   - ADMIN_PASSWD
#   - OAuth client secrets
#   - Cloud storage credentials
#
# Tier 2: Supabase Edge Function secrets (CLI-managed)
#   - SUPABASE_SERVICE_ROLE_KEY
#   - ODOO_USER, ODOO_DB, ODOO_URL
#   - SEED_RUN_TOKEN
#   - API keys (semi-sensitive)
#
# Tier 3: Environment variables (.env.local, gitignored)
#   - Non-sensitive configuration
#   - Development-only values
#   - URLs, usernames, ports
#
# Tier 4: NEVER STORE HERE
#   - Passwords, tokens, API secrets in git
#   - Service role keys in frontend code
#   - Credentials in odoo.conf (use ${VAR} placeholders)
#
# ============================================================================
# VERIFICATION
# ============================================================================
# List Supabase function secrets (safe, no values shown):
#   supabase functions secrets list
#
# Test secret retrieval in Edge Function:
#   Add temporary log: console.log("ODOO URL:", Deno.env.get("ODOO_URL"));
#   Deploy: supabase functions deploy seed-odoo-finance
#   Invoke: curl -H "Authorization: Bearer $SEED_RUN_TOKEN" \
#     "${SUPABASE_URL}/functions/v1/seed-odoo-finance"
#   Check logs: supabase functions logs seed-odoo-finance
#
# ============================================================================
