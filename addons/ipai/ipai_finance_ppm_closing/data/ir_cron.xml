<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <!-- Monthly cron to generate Month-End Close tasks -->
    <!-- Runs on 3rd business day before month-end to create next month's tasks -->
    <record id="ir_cron_month_end_close_generate" model="ir.cron">
        <field name="name">Generate Month-End Close Tasks</field>
        <field name="model_id" ref="base.model_ir_actions_server"/>
        <field name="state">code</field>
        <field name="code">
# Load seed from ir.config_parameter and run generator
# Uses Asia/Manila timezone for deadline calculations
import logging
_logger = logging.getLogger(__name__)
try:
    result = env['ipai.close.generator'].run_from_config(
        cycle_code='MONTH_END_CLOSE',
        cycle_key=None,  # Auto-compute from current date
        dry_run=False
    )
    _logger.info(
        "Month-End Close generator completed: status=%s, created=%d, updated=%d",
        result.get('status', 'unknown'),
        result.get('counts', {}).get('created', 0),
        result.get('counts', {}).get('updated', 0),
    )
except Exception as e:
    _logger.exception("Month-End Close generator failed: %s", e)
        </field>
        <field name="interval_number">1</field>
        <field name="interval_type">months</field>
        <field name="numbercall">-1</field>
        <field name="active">False</field>
        <field name="priority">10</field>
        <field name="doall" eval="False"/>
    </record>

    <!-- Daily cron to check for BIR filing tasks that need generation -->
    <!-- Runs daily at 8 AM Manila time to create upcoming BIR tasks -->
    <record id="ir_cron_bir_filing_check" model="ir.cron">
        <field name="name">Check BIR Filing Tasks</field>
        <field name="model_id" ref="base.model_ir_actions_server"/>
        <field name="state">code</field>
        <field name="code">
# Load seed and check for upcoming BIR filings
# Uses Asia/Manila timezone for deadline calculations
import logging
_logger = logging.getLogger(__name__)
try:
    result = env['ipai.close.generator'].run_from_config(
        cycle_code='BIR_TAX_FILING',
        cycle_key=None,
        dry_run=False
    )
    _logger.info(
        "BIR Filing generator completed: status=%s, created=%d, updated=%d",
        result.get('status', 'unknown'),
        result.get('counts', {}).get('created', 0),
        result.get('counts', {}).get('updated', 0),
    )
except Exception as e:
    _logger.exception("BIR Filing generator failed: %s", e)
        </field>
        <field name="interval_number">1</field>
        <field name="interval_type">days</field>
        <field name="numbercall">-1</field>
        <field name="active">False</field>
        <field name="priority">20</field>
        <field name="doall" eval="False"/>
    </record>
</odoo>
