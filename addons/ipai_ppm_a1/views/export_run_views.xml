<?xml version="1.0" encoding="utf-8"?>
<odoo>
  <record id="view_ipai_export_run_tree" model="ir.ui.view">
    <field name="name">ipai.repo.export_run.tree</field>
    <field name="model">ipai.repo.export_run</field>
    <field name="arch" type="xml">
      <list>
        <field name="name"/>
        <field name="state" widget="badge"
               decoration-info="state == 'draft'"
               decoration-success="state == 'done'"
               decoration-danger="state == 'failed'"/>
        <field name="exported_at"/>
        <field name="export_path"/>
        <field name="webhook_status"/>
      </list>
    </field>
  </record>

  <record id="view_ipai_export_run_form" model="ir.ui.view">
    <field name="name">ipai.repo.export_run.form</field>
    <field name="model">ipai.repo.export_run</field>
    <field name="arch" type="xml">
      <form>
        <header>
          <button name="action_generate_payload" type="object"
                  string="Generate Payload" class="btn-primary"/>
          <button name="action_write_to_path" type="object"
                  string="Write to Path"/>
          <button name="action_post_webhook" type="object"
                  string="Post Webhook"/>
          <field name="state" widget="statusbar"/>
        </header>
        <sheet>
          <group>
            <group>
              <field name="name"/>
              <field name="exported_at"/>
            </group>
            <group>
              <field name="export_path"/>
              <field name="webhook_url"/>
              <field name="webhook_status" readonly="1"/>
            </group>
          </group>
          <field name="payload_json" nolabel="1" widget="text"
                 placeholder="Generated JSON payload will appear here..."/>
        </sheet>
        <chatter/>
      </form>
    </field>
  </record>

  <record id="action_ipai_export_runs" model="ir.actions.act_window">
    <field name="name">Export Runs</field>
    <field name="res_model">ipai.repo.export_run</field>
    <field name="view_mode">list,form</field>
  </record>

  <menuitem id="ipai_ppm_a1_menu_export_runs" name="Export Runs"
            parent="ipai_ppm_a1_menu_admin"
            action="action_ipai_export_runs" sequence="30"/>
</odoo>
