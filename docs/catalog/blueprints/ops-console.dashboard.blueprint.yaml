id: ops-console.dashboard
title: Ops Console Dashboard (Vercel Admin + shadcn baseline)
category: ops-console

sources:
  - type: vercel-template
    url: https://vercel.com/templates/next.js/nextjs-shadcn-ui-admin-dashboard
    catalog_id: nextjs-shadcn-admin
  - type: vercel-example
    url: https://github.com/vercel/next.js/tree/main/examples/with-supabase
    catalog_id: with-supabase

target:
  app_dir: apps/ops-console
  package_manager: pnpm
  creates_new_app: false

variables:
  - name: VERCEL_PROJECT_NAME
    required: true
    description: Vercel project name for ops-console
    example: odooops-console
  - name: VERCEL_TEAM_ID
    required: true
    description: Vercel team identifier
    example: team_xxxxxxxxxxx
  - name: NEXT_PUBLIC_SUPABASE_URL
    required: true
    description: Supabase project URL
    example: https://spdtwktxdalcfigzeqrz.supabase.co
  - name: NEXT_PUBLIC_SUPABASE_ANON_KEY
    required: true
    description: Supabase anonymous key (public, safe for browser)
    example: eyJhbGciOiJIUzI1...
  - name: SUPABASE_SERVICE_ROLE_KEY
    required: true
    description: Supabase service role key (server-only)
    example: eyJhbGciOiJIUzI1...
  - name: SUPABASE_MANAGEMENT_API_TOKEN
    required: true
    description: Supabase Management API token (server-only)
    example: sbp_xxxxxxx

automation:
  steps:
    - name: scaffold_routes
      description: Ensure all required top-level routes exist in app/
      agent_instruction: |
        Create stub page.tsx files for any missing routes in apps/ops-console/app/:
        - /overview (home dashboard with stat cards)
        - /platform (Management API scaffold â€” already exists)
        - /observability (already exists)
        - /deployments (Vercel deployments list)
        - /environments (Vercel env vars surface)
        - /gates (CI gate status overview)
        - /modules (Odoo module registry)
        - /runbooks (links to docs/ops/ runbooks)
        - /settings (project settings scaffold)
        Each stub must use existing shadcn/ui Card + Badge primitives only.

    - name: wire_sidebar_nav
      description: Add all routes to the sidebar navigation
      agent_instruction: |
        Update the sidebar navigation component in apps/ops-console to list all routes
        from the scaffold_routes step. Use lucide-react icons. Group as:
        - Monitoring: Overview, Observability
        - Platform: Platform (Supabase), Environments, Deployments
        - Quality: Gates, Modules
        - Reference: Runbooks, Settings

    - name: wire_env
      description: Ensure env var placeholders follow server-only conventions
      agent_instruction: |
        Audit apps/ops-console for any NEXT_PUBLIC_ prefix on server-only variables
        (SUPABASE_SERVICE_ROLE_KEY, SUPABASE_MANAGEMENT_API_TOKEN, DIGITALOCEAN_API_TOKEN,
        ANTHROPIC_AUTH_TOKEN). Remove NEXT_PUBLIC_ from any that appear there.
        Add all required env vars to apps/ops-console/.env.agent.example.

    - name: add_ci
      description: Verify app-scoped CI gates exist
      agent_instruction: |
        Check that .github/workflows/ contains these path-filtered workflows for
        apps/ops-console/**:
        - ops-console-check.yml (ESLint + TypeScript + Prettier)
        - ops-console-playwright.yml (Playwright smoke test)
        - ops-console-bundle-size.yml (bundle size delta)
        If any are missing, create them following the pattern in existing workflows.

verification:
  required_checks:
    - ops-console-check
    - ops-console-playwright
    - ops-console-bundle-size
    - golden-path-summary
  preview:
    expectations:
      - vercel-preview-url-posted-to-pr
      - deployment-protection-enabled
      - all-routes-render-without-500

rollback:
  strategy: revert_pr
  notes: All changes are additive (new files + route stubs). Revert PR if issues arise.

notes:
  minor_customization:
    - Set Vercel Root Directory to apps/ops-console (vercel link --repo from apps/ops-console)
    - Pull env vars from Vercel (vercel env pull .env.local) after linking
    - Enable Deployment Protection in Vercel project settings for the team
