{"version":3,"sources":["../../../../../../../../../../Documents/GitHub/Insightpulseai/odoo/templates/odooops-console/app/%28app%29/projects/%5BprojectId%5D/builds/%5BbuildId%5D/logs/page.tsx"],"sourcesContent":["import { createClient } from \"@/lib/supabase/server\";\n\ninterface LogEntry {\n  id: string;\n  timestamp: string;\n  level: \"info\" | \"warn\" | \"error\" | \"debug\";\n  message: string;\n  phase?: string;\n}\n\nfunction formatTimestamp(ts: string): string {\n  const date = new Date(ts);\n  return date.toLocaleString(\"en-US\", {\n    year: \"numeric\",\n    month: \"2-digit\",\n    day: \"2-digit\",\n    hour: \"2-digit\",\n    minute: \"2-digit\",\n    second: \"2-digit\",\n    hour12: false,\n  });\n}\n\nexport default async function BuildLogsPage({\n  params,\n}: {\n  params: Promise<{ projectId: string; buildId: string }>;\n}) {\n  const { projectId, buildId } = await params;\n\n  const supabase = await createClient();\n\n  // Call RPC: ops.build_logs(p_build_id, p_limit, p_offset)\n  const { data: logsData, error } = await supabase.rpc(\"ops.build_logs\", {\n    p_build_id: buildId,\n    p_limit: 1000,\n    p_offset: 0,\n  });\n\n  if (error) {\n    return (\n      <div className=\"space-y-4\">\n        <div className=\"flex items-center justify-between\">\n          <h2 className=\"text-lg font-semibold\">Build Logs</h2>\n        </div>\n        <div className=\"rounded-md bg-red-50 p-4\">\n          <h3 className=\"text-sm font-medium text-red-800\">\n            Error loading logs\n          </h3>\n          <p className=\"mt-2 text-sm text-red-700\">{error.message}</p>\n        </div>\n      </div>\n    );\n  }\n\n  const logs: LogEntry[] =\n    logsData?.map((log: any) => ({\n      id: log.id.toString(),\n      timestamp: formatTimestamp(log.ts),\n      level: log.level,\n      message: log.message,\n      phase: log.phase,\n    })) || [];\n\n  const levelColors = {\n    info: \"text-blue-600\",\n    warn: \"text-yellow-600\",\n    error: \"text-red-600\",\n    debug: \"text-gray-600\",\n  };\n\n  const levelBadges = {\n    info: \"INFO\",\n    warn: \"WARN\",\n    error: \"ERROR\",\n    debug: \"DEBUG\",\n  };\n\n  return (\n    <div className=\"space-y-4\">\n      <div className=\"flex items-center justify-between\">\n        <h2 className=\"text-lg font-semibold\">Build Logs</h2>\n        <div className=\"flex gap-2\">\n          <button className=\"px-3 py-1.5 text-sm border border-gray-300 rounded hover:bg-gray-50\">\n            Download\n          </button>\n          <button className=\"px-3 py-1.5 text-sm border border-gray-300 rounded hover:bg-gray-50\">\n            Auto-scroll\n          </button>\n        </div>\n      </div>\n\n      {logs.length === 0 ? (\n        <div className=\"rounded-lg border-2 border-dashed border-gray-300 p-12 text-center\">\n          <h3 className=\"text-lg font-medium text-gray-900\">No logs yet</h3>\n          <p className=\"mt-2 text-sm text-gray-500\">\n            Build logs will appear here once the build starts.\n          </p>\n        </div>\n      ) : (\n        <>\n          {/* Log Viewer */}\n          <div className=\"bg-gray-900 text-gray-100 rounded-lg p-4 font-mono text-sm overflow-x-auto\">\n            <div className=\"space-y-1\">\n              {logs.map((log) => (\n                <div key={log.id} className=\"flex gap-4\">\n                  <span className=\"text-gray-500 flex-shrink-0\">\n                    {log.timestamp}\n                  </span>\n                  {log.phase && (\n                    <span className=\"text-cyan-400 flex-shrink-0 w-20\">\n                      [{log.phase.toUpperCase()}]\n                    </span>\n                  )}\n                  <span\n                    className={`flex-shrink-0 w-14 ${levelColors[log.level]}`}\n                  >\n                    {levelBadges[log.level]}\n                  </span>\n                  <span className=\"flex-1\">{log.message}</span>\n                </div>\n              ))}\n            </div>\n          </div>\n\n          <div className=\"text-sm text-gray-600\">\n            Showing {logs.length} log entries\n          </div>\n        </>\n      )}\n    </div>\n  );\n}\n"],"names":[],"mappings":"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"}